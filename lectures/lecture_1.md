---
title: "Теория вероятностей и математическая статистика"
subtitle: "Вероятностное пространство. Классическая, комбинаторная вероятность. "
institute: "ВШБ Бизнес-информатика"
author: "Глеб Карпов"
format: 
    beamer:
        pdf-engine: xelatex
        aspectratio: 169
        fontsize: 9pt
        theme: Singapore
        fonmttheme: serif
        section-titles: true
        incremental: true
        include-in-header: ../files/xeheader.tex  # Custom LaTeX commands and preamble
---
## Андрей Колмогоров меняет всё
## Описание случайного эксперимента
### Пространство элементарных исходов
\begin{itemize}
\item Множество, которое содержит все возможные \textit{уникальные} результаты случайного эксперимента:
$$
    \Omega = \{ \omega_1, \, \omega_2, \, \omega_n, \, \ldots  \}
$$
\item Может быть конечным или бесконечным
\item Критически зависит от установки случайного эксперимента и того, что мы хотим наблюдать и описывать
\end{itemize}

## Описание случайного эксперимента
### Пространство элементарных исходов: примеры

- Подбрасываются две визуально различимые монеты: $\Omega = \{ Hh, \, Tt, \, Ht, \, Th \}$
- Подбрасываются две идентичные монеты: $\Omega = \{ 2H, \, 2T, \, Diff\}$
- Идентичные монеты с внедренным различием: $\Omega = \{ Hh, \, Tt, \, Ht, \, Th \}$
- Кубик со сторонами-буквами: $\Omega = \{ a, \, b, \, c, \, d, \, e, \, f \}$

## Описание случайного эксперимента
### Событие

* Зачастую нас интересует не конкретный элементарный исход, а набор из нескольких, e.g.  "Если выпадет 2, 3, 6", то мы получим выигрыш
* Множество, построенное из одного или нескольких элементарных исходом называют \textit{событием}
* Важное отличие от элементарного исхода: исход случается \textit{один и только один}, событий может случиться одновременно много!

* ::: {.callout-tip title="Важно!"}
 Мы говорим, что *событие произошло*, если реализовался какой-то из элементарных исходов этого события.
:::

## Описание случайного эксперимента
### Пространство событий

\begin{itemize}
\item Множество, которое содержит все возможные \textit{события}, которые можно построить из множества исходов $\Omega$
\item Иными словами, множество всех возможных подмножеств $\Omega$:
$$
    \mathcal{F} = \{ A_1, \, A_2, \, A_n, \, \ldots  \}, \; \forall A_i \subset \Omega
$$
\item Само пространство элементарных исходов тоже событие: $\Omega \subset \Omega$, поэтому $\Omega \in \mathcal{F}$
\end{itemize}

\begin{center}
\begin{tikzpicture}
    % Рисуем круг для множества (справа)
    \draw[thick, fill=blue!10] (3.5,0.5) circle (2.);
    
    % Обозначение множества
    \node[above] at (3.5,2.5) {\small (Пример $\mathcal{F}$: все подмножества $\{a,b,c\}$)};
    
    % Все 8 подмножеств
    \node at (3.5,1.5) {$\{a,b,c\}$};
    \node at (2,1.) {$\{a,b\}$};
    \node at (5,1.) {$\{a,c\}$};
    \node at (3.5,1.) {$\{b,c\}$};
    \node at (2,0) {$\{a\}$};
    \node at (5,0) {$\{b\}$};
    \node at (3.5,0) {$\{c\}$};
    \node at (3.5,-1.) {$\{\varnothing \}$};
    
    % Новый круг слева с общими событиями
    \draw[thick, fill=green!10] (-3.5,0.5) circle (2.);
    
    % Обозначение множества
    \node[above] at (-3.5,2.5) {\small ($\mathcal{F}$, в общем виде)};
    
    % Общие события
    \node at (-3.5,1.5) {$\Omega$};
    \node at (-4.7,1.) {$A_1$};
    \node at (-2.3,1.) {$A_2$};
    \node at (-3.5,1.) {$A_3$};
    \node at (-4.7,0) {$A_k$};
    \node at (-2.3,0) {$A_n$};
    \node at (-3.5,0) {$\vdots$};
    \node at (-3.5,-1.) {$\varnothing$};
\end{tikzpicture}
\end{center}

## Описание случайного эксперимента
### Пространство событий

:::{.callout-question}
Если мощность пространства элементарных исходов $|\Omega| = n$, какая будет мощность пространста событий $|\mathcal{F}|$?
:::


## Описание случайного эксперимента
### Вероятность
- В конечном счете мы хотим наклеить на каждое событие "бирку" с информацией о том, насколько мы уверены в том, что событие случится
- Этот коэффициент нашей уверенности решили измерять от $0$ до $1$, его-то и называем *вероятностью*
- Формально, вероятность представляет собой функцию, которая каждому событию ставит в соответствие число:
$$
    P(X): \, \mathcal{F} \longrightarrow [0,1] \subset \mathbb{R} 
$$

\begin{tikzpicture}
    % Левый круг - область определения (пространство событий)
    \draw[thick, fill=blue!10] (0,0) circle (2);
    \node at (0,0) {$\mathcal{F}$};
    
    % Правый круг - область значений (вещественные числа от 0 до 1)
    \draw[thick, fill=green!10] (10,0) circle (1.0);
    \node at (10,0) {$[0,1]$};
    
    % Стрелка от левого к правому кругу (изогнутая)
    \draw[thick, ->] (2.2,0) .. controls (5, 1) and (5,1) .. (8.8,0) node[midway, above] {$P(X)$};
\end{tikzpicture}

## Свойства вероятностной функции
\begin{itemize}
\item $0 \leq P(X) \leq 1, \; \forall X \in \mathcal{F}$
\item $P(\Omega) = 1$, $P(\varnothing) = 0$
\item \textit{Свойство аддитивности вероятности}:
$$
    \forall X, \, Y \in \mathcal{F}: \, X \cap Y = \varnothing, \, P(X \cup Y) = P(X) + P(Y)
$$

Более душно: Если коллекция событий $A_1, \,  A_2, \, \ldots$ - попарно не пересекаются, i.e. $A_i \cap A_j = \varnothing, \, i \neq j$, то:
$$
    P\left(\bigcup_{i=1}^m A_i\right)=\sum_{i=1}^m P\left(A_i\right)
$$
\end{itemize}

## Вероятность
### Комплиментарные события и формула включений исключений
::: {.columns}
::: {.column width="40%"}
\begin{tikzpicture}[scale=1.2]
  % Прямоугольное пространство выборки Ω
  \draw[thick, black] (0,0) rectangle (5,4);
  \node[above] at (3,4) {\Large $\Omega$};
  
  % Событие A (круг слева)
  \draw[thick, blue, fill=blue!20] (1.5,2) circle (1.3);
  \node[blue] at (0.7,2.8) {\Large $A$};
  
  % Событие B (круг справа)
  \draw[thick, red, fill=red!20] (3.5,2) circle (1.0);
  \node[red] at (4.3,2.8) {\Large $B$};
  
  % Пересечение A ∩ B (закрашено более темным цветом)
  \begin{scope}
    \clip (1.5,2) circle (1.3);
    \fill[purple!40] (3.5,2) circle (1.0);
  \end{scope}
  
  % Подпись пересечения
  \node[purple, font=\large] at (3,2) {$A \cap B$};
  
  % Подписи областей
  \node[blue] at (0.4,1.0) {$\Omega \setminus A$};
  \node[blue] at (0.4,0.6) {$A^c, \, \bar{A}$};
  \node[red] at (4.6,1.0) {$\Omega \setminus B$};
  \node[blue] at (4.6,0.6) {$B^c, \, \bar{B}$};
  \node[black] at (0.7,3.5) {$(A \cup B)^c$};
\end{tikzpicture}
:::

::: {.column width="55%"}
- **Свойство**: Если $A \in \mathcal{F}$, то $P(A) + P(\Omega \backslash A) = 1$.

События $A$ и $\bar{A} = \Omega \backslash A$ такие, что $A \cap \bar{A} = \varnothing$, и $\Omega = A \cup \bar{A}$, откуда при помощи свойств вероятности получим: $P(\Omega) = P(A \cup \bar{A}) = P(A) + P(\Omega \backslash A) = 1$

- **Формула включений-исключений**: Если $A, B \in \mathcal{F}$, то 
$$
    P(A \cup B) = P(A)  + P(B) - P(A \cap B)
$$
Событие $A$ - объединение непересекающихся $A \backslash B$ и $A \cap B$, следовательно $P(A)=P(A \backslash B) + P(A \cap B)$ и симметрично $P(B)=P(B \backslash A) + P(A \cap B)$.
\begin{gather*}
P(A)+P(B) =P(A \backslash B)+2 P(A \cap B)+P(B \backslash A) \\
=P((A \backslash B) \cup(A \cap B) \cup(B \backslash A))+P(A \cap B) \\
=P(A \cup B)+P(A \cap B) .
\end{gather*}


- **Свойство**: Если $A, B \in \mathcal{F}$ and $A \subseteq B$, то $P(A) \leq P(B)$.
Показать просто: $P(B) = P(A) + P(B \backslash A) \geq P(A)$.
:::
:::

## Классическая вероятность
- Самая первая модель вероятностного эксперимента, суть которой состоит в предположении о равной вероятности элементарных исходов случайного эксперимента. Под это подходят многие дискретные задачи, связанные со случайным выбором карт, шариков, людей, бросками кубиков и монеток, *etc*.
- Формализуем: $\Omega = \{ \omega_1, \; \ldots, \; \omega_n \}$, $P(\{\omega_1\}) = \ldots = P(\{\omega_n\}) = p$.
- Применим свойства вероятности, чтобы получить интуитивно понятный результат о вероятности элементарного исхода:
\begin{gather*}
    \Omega = \{ \omega_1 \} \cup \cdots \cup \{ \omega_n \} = \bigcup\limits_{i=1}^{n} \{ \omega_i \} \\
    P(\Omega) = P \left( \bigcup\limits_{i=1}^{n} \{ \omega_i \} \right) = \sum\limits_{i=1}^{n} P(\{ \omega_i \}) = n \cdot p = 1 \rightarrow p = \frac{1}{n}
\end{gather*}

## Классическая вероятность
### Первая важная формула
- Без потери общности предположим, что некое событие $A$ состоит из $k \leq n$ элементарных исходов, $A = \{\omega_1, \; \ldots, \; \omega_k \}$. Нас интересует $P(A)$.
- Получим формулу для вероятности $A$:
\begin{gather*}
    A = \{ \omega_1 \} \cup \cdots \cup \{ \omega_k \} = \bigcup\limits_{i=1}^{k} \{ \omega_i \} \\
    P(A) = P \left( \bigcup\limits_{i=1}^{k} \{ \omega_i \} \right) = \sum\limits_{i=1}^{k} P(\{ \omega_i \}) = k \cdot p = \frac{k}{n} = \frac{|A|}{|\Omega|}
\end{gather*}

## Комбинаторная вероятность
### Basic principle of counting

:::{.callout-definition}
Если $r$ экспериментов должны быть проведены таким образом, что первый может привести к любому из $n_1$ возможных исходов; и если для каждого из этих $n_1$ возможных исходов есть $n_2$ возможных исхода второго эксперимента; и если для каждого из возможных исходов первых двух экспериментов есть $n_3$ возможных исхода третьего эксперимента; и если ..., то всего существует $n_1 \cdot n_2 \cdots n_r$ возможных исходов $r$ экспериментов.
:::
\begin{tikzpicture}[scale=0.6]
    % Определяем размеры и позиции (уменьшены)
    \def\sectorwidth{2.5}
    \def\sectorheight{6}
    \def\boxheight{0.8}
    \def\boxwidth{2}
    \def\spacing{1.2}
    
    % Левый сектор A (3 блока)
    \draw[thick, fill=blue!20] (0,0) rectangle (\sectorwidth,\sectorheight);
    \node[above, font=\small] at (\sectorwidth/2,\sectorheight) {Exp A};
    
    % Средний сектор B (4 блока)
    \draw[thick, fill=green!20] (3.5,0) rectangle (3.5+\sectorwidth,\sectorheight);
    \node[above, font=\small] at (3.5+\sectorwidth/2,\sectorheight) {Exp B};
    
    % Правый сектор C (3 блока)
    \draw[thick, fill=orange!20] (7,0) rectangle (7+\sectorwidth,\sectorheight);
    \node[above, font=\small] at (7+\sectorwidth/2,\sectorheight) {Exp C};
    
    % Блоки в левом секторе A (3 штуки)
    \foreach \i in {1,2,3} {
        \def\ypos{\sectorheight - \i*\spacing - \boxheight/2}
        \draw[thick, fill=white] (0.2,\ypos-\boxheight/2) rectangle (0.2+\boxwidth,\ypos+\boxheight/2);
        \node[font=\tiny] at (0.2+\boxwidth/2,\ypos) {A\i};
    }
    
    % Блоки в среднем секторе B (4 штуки)
    \foreach \i in {1,2,3,4} {
        \def\ypos{\sectorheight - \i*\spacing - \boxheight/2}
        \draw[thick, fill=white] (3.7,\ypos-\boxheight/2) rectangle (3.7+\boxwidth,\ypos+\boxheight/2);
        \node[font=\tiny] at (3.7+\boxwidth/2,\ypos) {B\i};
    }
    
    % Блоки в правом секторе C (3 штуки)
    \foreach \i in {1,2,3} {
        \def\ypos{\sectorheight - \i*\spacing - \boxheight/2}
        \draw[thick, fill=white] (7.2,\ypos-\boxheight/2) rectangle (7.2+\boxwidth,\ypos+\boxheight/2);
        \node[font=\tiny] at (7.2+\boxwidth/2,\ypos) {C\i};
    }
    
    % Линии A → B (все блоки A соединяются со всеми блоками B)
    \foreach \i in {1,2,3} {
        \def\yposA{\sectorheight - \i*\spacing - \boxheight/2}
        \foreach \j in {1,2,3,4} {
            \def\yposB{\sectorheight - \j*\spacing - \boxheight/2}
            \draw[thin, gray] (0.2+\boxwidth,\yposA) -- (3.7,\yposB);
        }
    }
    
    % Линии B → C (все блоки B соединяются со всеми блоками C)
    \foreach \i in {1,2,3,4} {
        \def\yposB{\sectorheight - \i*\spacing - \boxheight/2}
        \foreach \j in {1,2,3} {
            \def\yposC{\sectorheight - \j*\spacing - \boxheight/2}
            \draw[thin, gray] (3.7+\boxwidth,\yposB) -- (7.2,\yposC);
        }
    }
\end{tikzpicture}

## Комбинаторная вероятность
### Перестановки

- **Мотивация**: Сколько разных упорядоченных последовательностей получается из множества $\{ a, b, c \}$

- $P^r_n = n \cdot (n-1) \cdot (n-2) \cdot \ldots \cdot (n - r + 1)$

## Комбинаторная вероятность
### Перестановки: примеры

- :::{.callout-question}
**Случайная выборка чисел**. Пусть популяция состоит из десяти цифр 0, 1, ..., 9. Каждая последовательность из пяти цифр представляет выборку размера $r = 5$. Какова вероятность того, что пять последовательных случайных цифр все различны?
:::
- $P = \frac{P_{10}^5}{10^5} = 0.3024$.



## Комбинаторная вероятность
### Комбинации

- **Мотивация**: Извлечь три элемента из множества $\{ A, B, C, D, E \}$

- В общем случае, поскольку $n(n − 1)···(n− k + 1)$ представляет количество различных способов, которыми группа из $k$ элементов может быть выбрана из $n$ элементов, когда порядок выбора важен, и поскольку каждая группа из $k$ элементов будет подсчитана $k!$ раз в этом подсчете, следует, что количество различных групп из $k$ элементов, которые могут быть образованы из множества $n$ элементов, равно
$$
\frac{n(n-1) \cdots(n-k+1)}{k!}=\frac{n!}{(n-k)!k!}
$$

- :::{.callout-definition}
Мы определяем $C_n^k$, для $k \leq n$, как
$$
C_n^k = \frac{n!}{(n-k)!k!},
$$
и говорим, что $C_n^k$ представляет количество возможных комбинаций (коллекций) размера $k$, полученных из $n$ объектов. Порядок слкдования элементов в данном случае не считается важным.
:::

## Комбинаторная вероятность
### Комбинации: пример

Часто задачи подходят под модель извлечения шариков из мешка.

**Пример**: Мешок содержит 15 шариков, из которых 10 красных и 5 белых. Из мешка выбирают 4 шарика.

Здесь есть неоднозначность: например, если при одном извлечении я выбираю четыре красных шарика, а при другом извлечении четыре других красных шарика, считаются ли эти выборки одинаковыми или нет?

Мы будем предполагать, что это не одинаковые выборки. Например, мы можем представить, что шарики пронумерованы, так что мы можем различать шарики одного цвета. Такой способ мышления очень полезен для вычисления вероятностей в классической схеме.

## Комбинаторная вероятность
### Комбинации: пример

- 10 красных, 5 белых, пронумерованных шариков

- :::{.callout-question}
Сколько различных выборок (размера 4) возможно?
:::
- Порядок не важен, но номера важны, поэтому мы выбираем 4 элемента из множества 10 + 5 элементов. Следовательно, ответ: $C_{15}^4 = 1365$.

- :::{.callout-question}
Сколько выборок (размера 4) состоят полностью из красных шариков?
:::
- Порядок не важен, но номера важны, мы выбираем 4 элемента из множества красных шариков. Следовательно, ответ: $C_{10}^4 = 210$.

## Комбинаторная вероятность
### Комбинации: пример

- 10 красных, 5 белых, пронумерованных шариков

- :::{.callout-question} 
Сколько выборок содержат 2 красных и 2 белых шарика?
:::
- Мы можем выбрать 2 пронумерованных красных шарика $C_{10}^2$ способами и 2 пронумерованных белых шарика $C_5^2$ способами. Ни один выбор не влияет на другой, поэтому ответ: $C_{10}^2 \cdot C_5^2 = 45 \cdot 10 = 450$.

- :::{.callout-question}
Сколько выборок (размера 4) содержат ровно 3 красных шарика?
:::
- Мы можем выбрать 3 пронумерованных красных шарика $C_{10}^3$ способами и 1 пронумерованный белый шарик $C_5^1$ способами. Ни один выбор не влияет на другой, поэтому ответ: $C_{10}^3 \cdot C_5^1 = 120 \cdot 5 = 600$.

## Комбинаторная вероятность
### Комбинации: пример

- :::{.callout-question}
Сколько выборок (размера 4) содержат не менее 3 красных шариков?
:::

- Это количество выборок с 3 красными плюс количество выборок с 4 красными. Мы можем выбрать 4 пронумерованных красных шарика $C_{10}^4$ способами и 0 пронумерованных белых шариков $C_5^0$ способами. Ни один выбор не влияет на другой, поэтому ответ: $C_{10}^4 \cdot C_5^0 = 210 \cdot 1 = 210$.
Из предыдущего примера, есть 600 способов выбрать выборки с ровно 3 красными шариками, поэтому наш ответ: $600 + 210 = 810$.

## Комбинаторная вероятность
### Смешанные задачи подсчета

- 10 красных, 5 белых, пронумерованных шариков

- :::{.callout-question}
Сколько выборок (размера 4) содержат хотя бы один красный шарик?
:::
- Это $C_{10}^1 \cdot C_5^3 + C_{10}^2 \cdot C_5^2 + C_{10}^3 \cdot C_5^1 + C_{10}^4 \cdot C_5^0$, что равно $10 \cdot 10 + 45 \cdot 10 + 120 \cdot 5 + 210 \cdot 1 = 100 + 450 + 600 + 210 = 1360$.

Это также общее количество выборок (1365) минус количество выборок без красных шариков, которое равно $C_{10}^0 \cdot C_5^4 = 5$.


## Геометрическая вероятность

### Определение
Геометрическая вероятность применяется к экспериментам, где пространство элементарных исходов $\Omega$ является подмножеством евклидова пространства (отрезок, площадь, объем).

### Основные формулы

**Для одномерного случая (отрезок):**
$$P(A) = \frac{\text{длина множества } A}{\text{длина множества } \Omega}$$

**Для двумерного случая (площадь):**
$$P(A) = \frac{\text{площадь множества } A}{\text{площадь множества } \Omega}$$

**Для трехмерного случая (объем):**
$$P(A) = \frac{\text{объем множества } A}{\text{объем множества } \Omega}$$

<!-- ## Геометрическая вероятность
### Пример: задача о встрече

::: {.columns}
::: {.column width="50%"}


\begin{tikzpicture}[scale=1.2]
  % Квадрат [0,1] × [0,1] - пространство выборки
  \draw[thick, black] (0,0) rectangle (4,4);
  \node[above] at (2,4.2) {\Large $\Omega = [0,1] \times [0,1]$};
  
  % Оси координат
  \draw[thin, gray] (0,0) -- (0,4.3);
  \draw[thin, gray] (0,0) -- (4.3,0);
  \node[right] at (4.3,0) {$x$};
  \node[above] at (0,4.3) {$y$};
  
  % Подписи осей
  \node[below] at (0,0) {$0$};
  \node[below] at (4,0) {$1$};
  \node[left] at (0,4) {$1$};
  
  % Область благоприятных исходов |x - y| ≤ 1/4
  % Заливаем полосу между линиями y = x + 1/4 и y = x - 1/4
  \fill[blue!30] (0,1) -- (3,4) -- (4,4) -- (4,3) -- (1,0) -- (0,0) -- cycle;
  
  % Две параллельные линии (масштаб 4x4)
  \draw[thick, blue] (0,1) -- (3,4);  % y = x + 1/4
  \draw[thick, blue] (1,0) -- (4,3);  % y = x - 1/4
  
  % Диагональ y = x
  \draw[thick, dashed, gray] (0,0) -- (4,4);
  \node[gray] at (3.5,3.5) {$y = x$};
  
  % Подпись области
  \node[blue, font=\large] at (2,2) {$|x - y| \leq \frac{1}{4}$};
  
  % Точка для примера
  \fill[red] (2.5,2.8) circle (0.05);
  \node[right, red] at (2.6,2.8) {$(x, y)$};
\end{tikzpicture}

:::

::: {.column width="45%"}

**Условие задачи:**

Два человека договариваются встретиться в определенном месте между 12:00 и 13:00. Каждый приходит в случайный момент времени и ждет 15 минут. Какова вероятность встречи?

**Решение:**

Пусть $x$ - время прихода первого человека, $y$ - время прихода второго человека.

Встреча произойдет, если $|x - y| \leq \frac{1}{4}$.

**Пространство выборки:** $\Omega = [0,1] \times [0,1]$

**Площадь благоприятной области:**
$$S_{\text{благ}} = 1 - 2 \cdot \frac{1}{2} \cdot \frac{3}{4} \cdot \frac{3}{4} = 1 - \frac{9}{16} = \frac{7}{16}$$

**Ответ:**
$$P(\text{встреча}) = \frac{S_{\text{благ}}}{S_{\Omega}} = \frac{7/16}{1} = \frac{7}{16}$$

:::
::: -->

## Геометрическая вероятность
### Классические задачи геометрической вероятности

1. **Задача о встрече**: Два человека договариваются встретиться в определенном месте между 12:00 и 13:00. Каждый приходит в случайный момент времени и ждет 15 минут. Какова вероятность встречи?

2. **Задача Бюффона**: Игла длины $l$ бросается на плоскость, разлинованную параллельными прямыми на расстоянии $d$ друг от друга. Какова вероятность пересечения иглы с линией?

3. **Задача о случайной точке в круге**: Точка выбирается случайно внутри круга радиуса $R$. Какова вероятность того, что расстояние от точки до центра меньше $r$?



